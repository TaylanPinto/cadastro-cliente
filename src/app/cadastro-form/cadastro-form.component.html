<form #f="ngForm" (ngSubmit)="saveClientFee(f)">

  <div class="mb-3">
    <label for="cpfCnpj" class="form-label">cpf/cnpj</label>
    <input [(ngModel)]="clientFee.cpfCnpj" type="text" class="form-control" id="cpfCnpj" name="cpfCnpj" placeholder="Digite seu cpf/cnpj" required #cpfCnpj="ngModel" [mask]="getcpfCnpj()">
    <div *ngIf="!cpfCnpj.valid && cpfCnpj.touched" class="alert alert-danger" role="alert">
      Campo obrigatório.
    </div>
  </div>

  <div class="mb-3">
    <label for="email" class="form-label">E-mail</label>
    <input [(ngModel)]="clientFee.email" type="email" class="form-control" id="email" name="email" placeholder="Digite seu E-mail" required email #email="ngModel">
    <div *ngIf="!email.valid && email.touched" class="alert alert-danger" role="alert">
      Campo obrigatório.
    </div>
  </div>

  <div class="row">
    <div class="col">
      <label for="razaoSocial" class="form-label">Razão social</label>
      <input [(ngModel)]="clientFee.razaoSocial" type="text" class="form-control" name="razao" id="razaoSocial" placeholder="Digite a Razão social" required #razao="ngModel">
      <div *ngIf="!razao.valid && razao.touched" class="alert alert-danger" role="alert">
        Campo obrigatório.
      </div>
    </div>

    <div class="col">
      <label for="Telefone" class="form-label">Telefone</label>
      <input [(ngModel)]="clientFee.telefone" type="text" class="form-control" name="telefone" id="Telefone" placeholder="Digite seu Número" required #telefone="ngModel" prefix="+55" mask="(00) 00000-0000">
      <div *ngIf="!telefone.valid && telefone.touched" class="alert alert-danger" role="alert">
        Campo obrigatório.
      </div>
    </div>
  </div>

  <div class="mb-3">
    <label for="faturamento" class="form-label">Faturamento</label>
    <div class="input-group mb-3">
      <span class="input-group-text">R$</span>
      <input [dropSpecialCharacters]="false" [(ngModel)]="clientFee.faturamento" type="text" class="form-control" name="faturamento" id="faturamento" placeholder="Digite o faturamento" required #faturamento="ngModel" mask="separator.2" thousandSeparator="." aria-label="Amount">
      <div *ngIf="!faturamento.valid && faturamento.touched" class="alert alert-danger" role="alert">
        Campo obrigatório.
      </div>
    </div>
  </div>

  <legend>Taxas</legend>

  <div class="mb-3">
    <label for="taxa" class="form-label">Débito</label>
    <input name="debit" [(ngModel)]="clientFee.debito" type="text" class="form-control" id="taxa" placeholder="0,00%" #debito="ngModel" required minlength="4" maxlength="5" suffix="%" mask="separator.2">
    <div *ngIf="!debito.valid && debito.touched" class="alert alert-danger" role="alert">
      Obrigatório.
    </div>
  </div>

  <label for="taxa" class="form-label">Crédito</label>

  <div class="row">
    <div class="col">
      <div>3X</div>
      <input type="text" id="parcelado3" class="form-control" placeholder="0,00%" name="parcelado3" [(ngModel)]="clientFee.parcelado3" #parcelado3="ngModel" required minlength="4" maxlength="5" suffix="%" mask="separator.2">
      <div *ngIf="!parcelado3.valid && parcelado3.touched" class="alert alert-danger" role="alert">
        Obrigatório.
      </div>
    </div>
    <div class="col">
      <div>6X</div>
      <input type="text" id="parcelado6" class="form-control" placeholder="0,00%" name="parcelado6" [(ngModel)]="clientFee.parcelado6" #parcelado6="ngModel" required minlength="4" maxlength="5" suffix="%" mask="separator.2">
      <div *ngIf="!parcelado6.valid && parcelado6.touched" class="alert alert-danger" role="alert">
        Obrigatório.
      </div>
    </div>
    <div class="col">
      <div>12X</div>
      <input type="text" id="parcelado12" class="form-control" placeholder="0,00%" name="parcelado12" [(ngModel)]="clientFee.parcelado12" #parcelado12="ngModel" required minlength="4" maxlength="5" suffix="%" mask="separator.2">
      <div *ngIf="!parcelado12.valid && parcelado12.touched" class="alert alert-danger" role="alert">
        Obrigatório.
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <label for="maq-model" class="form-label">Modelo</label>
      <select name="model" (change)="updateTotal()" [(ngModel)]="clientFee.modelo" id="maq-model" class="form-select" aria-label="Default select example">
        <option value="0" selected>Selecionar Maquina</option>
        <option *ngFor="let maquina of maquinas" [ngValue]="maquina">{{ maquina.nome }} - {{ maquina.valor }}</option>
      </select>
    </div>
    <div class="col">
      <label for="qnt-maq" class="form-label">Quantidade</label>
      <input name="maq_qty" (keyup)="updateTotal()" [(ngModel)]="clientFee.quantidade" id="qnt-maq" type="text" class="form-control" placeholder="Quantidade de Máquina" maxlength="1" required #quantidade="ngModel">
      <div *ngIf="!quantidade.valid && quantidade.touched" class="alert alert-danger" role="alert">
        Obrigatório.
      </div>
    </div>
  </div>


  <a [routerLink]="'/'" type="button" class="btn btn-secondary"> Cancelar</a>
  <button type="button" class="btn btn-primary" (click)="openModal(template)" [disabled]="!f.valid">Validar taxa</button>

</form>

<ng-template #template>
  <div class="modal-header">
    <h4 class="modal-title"> Reajuste das taxas</h4>
    <button type="button" class="btn-close close pull-right" aria-label="Close" (click)="modalRef?.hide()">
      <span aria-hidden="true" class="visually-hidden">&times;</span>
    </button>
  </div>
  <div class="modal-body">

    <div class="container overflow-hidden text-center">
      <div class="row gy-5">
        <div class="col-6">
          <ul>
            <li>Débito:</li>
            <ul>
              <li>À vista - <strong>{{ clientFee.debito }}%</strong></li>
            </ul>
            <li>Parcelado:</li>
            <ul>
              <li>3x - <strong>{{ clientFee.parcelado3 }}%</strong></li>
              <li>6x - <strong>{{ clientFee.parcelado6 }}%</strong></li>
              <li>12x - <strong>{{ clientFee.parcelado12 }}%</strong></li>
            </ul>
          </ul>
        </div>

      </div>
    </div>

    <div class="modal-footer">

      <button type="button" class="btn btn-secondary" (click)="voltar()">Cancelar</button>
      <button type="button" class="btn btn-primary" (click)="saveClientFee(f)" [disabled]="!f.valid">Salvar</button>


    </div>
  </div>
</ng-template>